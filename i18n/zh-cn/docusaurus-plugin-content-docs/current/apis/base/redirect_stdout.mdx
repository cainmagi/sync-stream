---
id: redirect_stdout
title: redirect_stdout
sidebar_label: redirect_stdout
slug: /apis/base/redirect_stdout
description: contextlib.redirect_stdout经过特殊封装的版本。
---

import IconExternalLink from "@theme/Icon/ExternalLink";

import vsiCheckIcon from "@iconify-icons/codicon/check";

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

import APITopBar, {IconObjType} from "@site/src/components/APITopBar";
import InlineIcon from "@site/src/components/InlineIcon";

<APITopBar
  type="class"
  isPrivate={true}
  isContext={true}
  source="base.redirect_stdout"
/>

```python
with redirect_stdout(target: SupportsWrite):
    ...
```

[`contextlib.redirect_stdout`<IconExternalLink/>][link-restdout]经过特殊封装的版本。

该上下文允许`syncstream.LineBuffer`或其镜像用作重定向的目标，并不引起任何类型检查异常。

:::tip

该上下文可能是不需要使用的，因为形如`LineBuffer`的缓存、现在本身就已经是一个上下文了。

由于缓存上下文会同时令`stdout`和`stderr`重定向，若不想重定向`stderr`，有可能还是会需要用该上下文。

:::

## 别名 {#aliases}

该类可以按以下方式之一获取

```python
import syncstream


syncstream.redirect_stdout
syncstream.base.redirect_stdouts
```

## 参数 {#arguments}

|   参数   |      类型       |               必选                | <center>说明</center>       |
| :------: | :-------------: | :-------------------------------: | :-------------------------- |
| `target` | `SupportsWrite` | <InlineIcon icon={vsiCheckIcon}/> | 支持`write`方法的可写缓存。 |

## 范例 {#example}

### <IconObjType type="term"/> 将stdout重定向到缓存 {#iconobjtype-typeterm-redirect-stdout-to-buffer}

<Tabs
  defaultValue="codes"
  values={[
    { label: 'Codes', value: 'codes', },
    { label: 'Better codes', value: 'better-codes', },
    { label: 'Results', value: 'results', },
  ]
}>

<TabItem value="codes">

```python showLineNumbers title="use_this_function.py"
import syncstream
from syncstream.base import redirect_stdout


buffer = syncstream.LineBuffer(10)
with redirect_stdout(buffer):
    for i in range(20):
        print(f'Message "{i:02d}".')
    print('No line break.', end='')

messages = buffer.read()
for mitem in messages:
    print(mitem)
```

</TabItem>

<TabItem value="better-codes">

```python showLineNumbers title="use_buffer_context_directly.py"
import syncstream


buffer = syncstream.LineBuffer(10)
with buffer:  # stdout和stderr都捕获了。
    for i in range(20):
        print(f'Message "{i:02d}".')
    print('No line break.', end='')

messages = buffer.read()
for mitem in messages:
    print(mitem)
```

</TabItem>

<TabItem value="results">

```shell
Message "11".
Message "12".
Message "13".
Message "14".
Message "15".
Message "16".
Message "17".
Message "18".
Message "19".
No line break.
```

</TabItem>
</Tabs>

[link-restdout]: https://docs.python.org/zh-cn/3/library/contextlib.html#contextlib.redirect_stdout
